# 📝 変更履歴 (Changelog)

このファイルは、DNS OSINT Pro ver2.0の重要な変更を記録します。

形式は [Keep a Changelog](https://keepachangelog.com/ja/1.0.0/) に基づいています。  
バージョニングは [Semantic Versioning](https://semver.org/lang/ja/) に準拠しています。

---

## [5.8.1] - 2025-11-05

### 🎨 UI/UX改善
- **Yahoo!サジェストを「開発中」表示に変更**:
  - 🚧「開発中」バッジを追加
  - Yahoo!検索へのリンクボタンを提供
  - より親切なメッセージ表示
  - 将来の実装を示唆

### 📝 ステータス
- Yahoo!サジェストは将来の課題として開発継続予定
- 現在はYahoo!検索への直接リンクで代替
- GoogleとBingのサジェストは正常動作

---

## [5.8.0] - 2025-11-05

### ✨ 新機能（Genspark推奨実装）
- **Yahoo!サジェストプロキシAPIを完全再実装**:
  - Gensparkディープリサーチ結果に基づく最適化実装
  - 推奨エンドポイント: `/search/suggest` を使用
  - `X-Requested-With: XMLHttpRequest` ヘッダーを追加
  - より詳細なエラーハンドリングとデバッグ機能

### 🔧 技術的改善
- YahooSuggestProxyクラスの実装（OOP設計）
- 4つのレスポンス形式に対応（OpenSearch、ResultSet、results、suggest）
- デバッグモードで詳細なトラブルシューティング情報を提供
- JSON_PRETTY_PRINTでデバッグ出力を見やすく

### 📚 参考資料
- Gensparkディープリサーチレポート
- 実装方法の技術比較と推奨度評価

---

## [5.7.2] - 2025-11-05

### 🎨 UI/UX改善
- **Yahoo!サジェストの表示メッセージを改善**:
  - より正確な説明に変更
  - 「Yahoo!のサジェストAPIは現在公開されていないため取得できません」
  - GoogleとBingのサジェストで十分に機能することを明示

### 📝 既知の制限
- Yahoo!のサジェストAPIは公開されていないため、現時点では取得できません
- GoogleとBingのサジェストは正常に動作します

---

## [5.7.1] - 2025-11-05

### 🐛 バグ修正
- **Yahoo!サジェストプロキシAPIを改善**:
  - 複数のYahoo!エンドポイントを試行
  - より詳細なエラーハンドリング
  - デバッグモードを追加（`?debug=1`パラメータ）
  - 文字化け対策（JSON_UNESCAPED_UNICODE）

### 🔧 技術的改善
- 3つの異なるYahoo! APIエンドポイントを試行
- レスポンス形式の自動判定（ResultSet、配列、results）
- SSL証明書エラーの回避

---

## [5.7.0] - 2025-11-05

### ✨ 新機能
- **Yahoo!サジェストをプロキシAPI経由で取得**:
  - CORS制限を完全に回避
  - サーバーサイドのプロキシAPIを使用
  - より確実にYahoo!サジェストを取得

### 🔧 技術的改善
- `yahoo-suggest-api.php`プロキシAPIを作成
- サーバーサイドでYahoo!にアクセスしてCORS制限を回避
- プロキシサーバーへの権限を追加

### 📝 セットアップ手順
1. `docs/yahoo-suggest-api.php`をサーバーにアップロード
2. `https://reverse-re-birth-hack.com/yahoo-suggest-api.php`にアクセス可能にする
3. 拡張機能がプロキシAPI経由でYahoo!サジェストを取得

---

## [5.6.9] - 2025-11-05

### 🐛 バグ修正
- **Yahoo!サジェストのエラーハンドリングを改善**:
  - HTMLが返ってきた場合はスキップするように修正
  - より適切なエンドポイント（OpenSearch形式）を優先
  - モバイルAPIへの権限を追加
  
### 📝 既知の制限
- Yahoo!のCORS制限が非常に厳しく、取得できない場合があります
- その場合はGoogleとBingのサジェストのみで動作します

---

## [5.6.8] - 2025-11-05

### 🔧 機能改善
- **Yahoo!サジェストのCORS制限を回避**:
  - 複数のYahoo!サジェストエンドポイントを試行
  - gossip API、検索サジェストAPI、リアルタイム検索APIの3つを順番に試行
  - より確実にYahoo!サジェストを取得できるように改善

### 🛠️ 技術的改善
- Yahoo!のサブドメイン（ff.search.yahoo.co.jp）への権限を追加
- 複数のレスポンス形式に対応

---

## [5.6.7] - 2025-11-05

### 🐛 バグ修正
- **Bingサジェストの不正確な結果を修正**:
  - ドメイン名で検索した場合、そのドメインに関連しないサジェストを除外
  - 例: `kimito-link.com`で検索時に`kimi.com`、`kimicomm.com`などが表示される問題を修正
  - ドメインの主要部分（例: `kimito-link`）を含むサジェストのみを表示

### 🔧 技術的改善
- ドメイン検索時のサジェストフィルタリング処理を追加
- ネガティブ検出時とノーマル表示時の両方でフィルタリングを適用

---

## [5.6.6] - 2025-11-05

### 🐛 重要なバグ修正
- **WHOIS情報が取得できない問題を完全に修正**:
  - サブドメインを含むURLでWHOIS検索すると「No match」エラーが発生していた
  - RDAPエンドポイントはルートドメインのみを受け付けるため、サブドメイン除去処理を追加
  - 日本ドメイン(.jp)とグローバルドメイン(.com)の両方に対応

### 🔧 技術的改善
- **RDAPクエリの最適化**:
  - `www.example.com` → `example.com` に自動変換
  - `domain.sakura.ad.jp` → `sakura.ad.jp` に自動変換
  - マルチレベルTLD（co.jp, ne.jp, ad.jpなど）に完全対応

- **WHOIS取得成功率の向上**:
  - .comドメインで6つのRDAPエンドポイントを試行
  - タイムアウトを10秒→5秒に短縮（高速化）
  - 404エラーの詳細なログ出力

- **日本ドメインWHOIS解析の改善**:
  - 旧形式のWHOISデータ（`domain:`, `g. [Organization]`など）に対応
  - 新旧両方の形式を自動判定してパース

### 🎨 その他の修正
- 風評健全度スコア計算の改善（ネガティブ1個でも適切に減点）
- 文字色の視認性改善（#666 → #333）

---

## [5.6.0] - 2025-11-04

### 🎨 UI/UX改善
- **LINEボタンのデザイン統一**: すべての相談ボタンを緑色（LINE公式カラー #06C755）に統一
  - rev.png（リバースハックのロゴ）を使用
  - 白文字で視認性を向上
  - ボタンらしいデザインでクリック率向上を期待
  
- **警告ボックスの背景色統一**: すべての警告（issues）ボックスを濃い赤色に統一
  - Mixed Content警告
  - WordPress/PHP警告
  - Contact Form 7警告
  - 深刻な問題（issues）警告
  - グラデーション: #d32f2f → #c62828

- **相談ボタンの文言統一**:
  - ITインフラ: 「リバースハックに相談（ITインフラ）」
  - 風評対策: 「リバースハックに相談（風評対策）」
  - 説明文: 「りんくが頼りにしている専門家 | レスポンス◎」

### 🔧 機能改善
- **HTTPSリダイレクトチェックのロジック改善**:
  - Chrome拡張機能のfetch制限を考慮した新しいロジックに変更
  - HTTPSでアクセスできている場合、HTTPリダイレクトも正常と判断
  - 誤検出（false positive）を削減

- **WordPress/PHPバージョン警告の分離**:
  - 専用の赤い警告ボックスで表示
  - 「深刻な問題」セクションから除外
  - より視認性の高い表示に改善

- **こん太のアドバイス表示ロジック改善**:
  - アドバイスがある場合のみ表示
  - アドバイスがない場合は空のボックスを非表示
  - UIのクリーンさを向上

### 🐛 バグ修正
- HTTPSリダイレクトチェックの誤検出を修正
- こん太のアドバイスボックスが空でも表示される問題を修正

---

## [5.2.0] - 2025-10-05

### ✨ 追加
- **サイト名抽出機能の大幅強化**: 医療機関名や施設名を優先的に検出
  - 医療機関: 〜医院、〜クリニック、〜病院、〜診療所など
  - 美容・サロン: 〜サロン、〜美容室、〜エステなど
  - 治療院: 〜整体院、〜接骨院、〜鍼灸院など
  - 飲食店: 〜レストラン、〜カフェ、〜居酒屋など
  - その他: 〜塾、〜ジム、〜法律事務所など

- **サジェストのリンク化**: Google/Yahoo!/Bingの検索結果へワンクリックでアクセス
  - 各サジェスト項目に🔗アイコンを追加
  - クリックすると該当する検索エンジンの検索結果ページを新しいタブで開く

- **口コミサイトリンク**: 主要な口コミサイトへの直接リンクボタンを追加
  - 総合口コミ: Googleマップ、Yahoo!知恵袋、みん評
  - 企業評判: 転職会議、OpenWork、エン ライトハウス、Indeed
  - サジェスト情報セクションに配置

### 🎨 改善
- **パックマンアニメーション**: りんくのサイズを45pxから60pxに拡大
  - バウンドする動きを追加（translateYアニメーション）
  - より目立つ動作で分析中であることを明確化

- **サジェスト表示の改善**:
  - リンクアイコンの追加で各検索エンジンへ直接アクセス可能に
  - レイアウトの最適化
  - 視認性の向上

- **UI/UXの大幅改善**:
  - 口コミサイトボタンのデザイン統一
  - ホバーエフェクトの追加
  - レスポンシブ対応の強化

### 🔧 修正
- サイト名抽出時の法人格除去ロジックを改善
- セパレーター処理の最適化
- エラーハンドリングの強化

### 📝 ドキュメント
- README.mdに「ビジネス利用」セクションを追加
- 風評被害対策サービスへの導線を強化
- スクリーンショットガイドを追加

---
  - 飲食店の検出（〜レストラン、〜カフェ、〜居酒屋等）
  - 教育・スポーツ施設の検出（〜塾、〜スクール、〜ジム等）
  - 専門サービスの検出（〜法律事務所、〜会計事務所等）
  - その他施設の検出（〜ホテル、〜旅館、〜動物病院等）
  - 全角→半角変換機能の追加

- **サジェストのリンク化**:
  - Google検索結果へのリンク追加（サジェストをクリックで検索）
  - Yahoo!検索結果へのリンク追加
  - Bing検索結果へのリンク追加
  - Google検索に「📍 検索した地点での表示です (Yokohama, Kanagawa)」の注意書き追加

- **口コミサイトリンクセクション**:
  - 総合口コミ: Googleマップ、Yahoo!知恵袋、みん評へのリンク
  - 企業評判: 転職会議、OpenWork、エン ライトハウス、Indeedへのリンク
  - 各口コミサイトへのワンクリックアクセス
  - ホバーエフェクト付きボタンデザイン

### 🎨 UI/UX改善
- **パックマンアニメーションの大幅改善**:
  - りんくのサイズを45px→60pxに拡大
  - バウンドする動きを追加（上下に揺れながら移動）
  - アニメーション時間を2.5秒→4秒に延長（よりゆっくり見やすく）
  - ボックスシャドウの強化で立体感向上

- **特別セクションの導入**:
  - サイト健康診断を1列フル幅表示に変更
  - サジェスト風評チェックを1列フル幅表示に変更
  - SEO・風評被害対策セクションを1列フル幅表示に変更
  - 視認性とレイアウトの大幅改善

- **ローディング表示の強化**:
  - ドット付きローディングアニメーション追加
  - より大きく見やすいローディング表示
  - リバースハックロゴの配置改善

### 🔧 改善
- サイト名抽出ロジックの優先順位最適化
- 固有名詞検出の精度向上
- エラーハンドリングの改善
- コードの可読性向上

---

## [5.2.0] - 2025-10-06

### ✨ 追加・改善
- **メールセキュリティチェックの強化**: サイト健康診断の前にSPF/DKIM/DMARCをチェック
- **問題の統合表示**: メールセキュリティ問題を健康診断のマイナス要素に統合
- **相談窓口の改善**: 「早速相談する」スタイルのボタンに変更、メール問題時も表示
- **WordPress詳細情報**: テーマ、プラグイン、PHPバージョンの検出を強化
- **パフォーマンススコア**: 応答速度とページサイズから総合スコアを算出
- **視覚的改善**: キャラクターアイコン付きの見やすいUI

### 🔧 技術的改善
- PHPバージョン検出の精度向上（複数の方法で検出）
- WordPressバージョン検出の精度向上（誤検出を防止）
- RDAP情報取得のCORS回避（background.js経由）

---

## [5.1.0] - 2025-10-05

### ✨ 追加
- **サイト健康診断機能**: りんく、こん太、たぬ姉によるキャラクター案内
  - WordPress検出とバージョン確認
  - SEO分析（タイトル、メタディスクリプション、Canonical、OGP）
  - セキュリティヘッダー診断（X-Frame-Options、HSTS、CSP等）
  - HTTPSリダイレクト確認
  - WWW統一チェック
  - パフォーマンス診断（キャッシュ、圧縮設定）
  - 詳細なエラーメッセージとCORS対応

- **メールセキュリティ診断機能**:
  - SPFレコード検証
  - DKIMレコード検出（一般的なセレクタを自動検索）
  - DMARCレコード検証
  - メールセキュリティリスクの警告表示
  - 設定不備による影響の説明

- **キャラクター案内システム**:
  - りんく（良好な点の説明）
  - こん太（改善点のアドバイス）
  - たぬ姉（深刻な問題の警告）
  - 各キャラクターのアイコン表示

### 🔧 改善
- サジェスト取得のエラーハンドリングを強化
- CORS制限への対応を改善
- タイムアウト処理の追加（10秒）
- より詳細なエラーメッセージ表示
- UI/UXの大幅改善（色分け、視認性向上）

### 🐛 修正
- `popup.js`の`els.companyName.value`参照エラーを修正
- サイト健康診断のタイムアウト問題を解決
- Yahoo!サジェストのCORS制限に対する適切なエラー表示

---

## [5.0.0] - 2025-10-04

### ✨ 追加
- **サジェスト汚染チェック機能**: 
  - Googleサジェスト取得
  - Yahoo!サジェスト取得
  - Bingサジェスト取得
  - ページタイトルからサイト名自動抽出
  - ネガティブキーワード自動検出（25種類以上）
  - 風評被害警告の自動表示
  - キーワードの赤字ハイライト表示

- **サイト名抽出ロジック**:
  - 【公式】【PR】などのプレフィックス除去
  - セパレーター（｜、|、-、・等）による分割
  - 法人格（株式会社、有限会社等）の除去
  - 長すぎる文字列の自動トリミング
  - 略称対応（エイリアス変換）

### 🔧 改善
- `background.js`に複数のサジェストAPI呼び出し機能を追加
- `Promise.allSettled`による並列処理でパフォーマンス向上
- エラーが発生してもすべてのAPIを試行する仕組み

### 📝 ドキュメント
- 風評被害対策のLINE相談リンク追加
- サジェストの説明を追加

---

## [4.0.0] - 2025-10-03

### 🔧 変更
- **Manifest V3への完全移行**
  - `service_worker`を使用したバックグラウンド処理
  - `host_permissions`の適切な設定
  - 非推奨のAPIをすべて削除

### ✨ 追加
- サーバー会社の自動識別機能を大幅拡張
  - 日本のホスティング11社に対応
  - 海外クラウド7社に対応
  - IP範囲からの推定機能
  - ホスト名、NS、MX、レジストラからの推定

### 🎨 改善
- UIを800x600pxに統一
- テーブル表示の改善
- アイコン画像の追加（りんく、こん太、たぬ姉）

---

## [3.0.0] - 2025-09-15

### ✨ 追加
- **WHOIS / RDAP情報取得機能**
  - ドメインRDAP
  - IP RDAP
  - レジストラ情報の表示
  - 登録日・有効期限の表示
  - ドメインステータスの日本語化

- **逆引き（PTR）機能**
  - IPアドレスからホスト名を取得
  - ホスト名からのサーバー推定

### 🔧 改善
- `utils.js`にRDAP関連関数を追加
- エラーハンドリングの改善

---

## [2.0.0] - 2025-09-01

### ✨ 追加
- **DNS情報取得機能**
  - A（IPv4）レコード
  - AAAA（IPv6）レコード
  - MXレコード
  - NSレコード
  - TXTレコード
  - CNAMEレコード

- **DNS over HTTPS (DoH) 対応**
  - Cloudflare DoH APIの使用
  - プライバシー保護されたDNS解決

### 🎨 UI
- ポップアップUIの作成
- テーブル形式での結果表示
- ローディング表示

---

## [1.0.0] - 2025-08-15

### ✨ 初回リリース
- Chrome拡張機能の基本構造
- 現在のタブのドメイン自動取得
- 手動入力によるドメイン検索
- 右クリックメニューからの照会機能

---

## 🔮 予定されている機能（Roadmap）

### [6.0.0] - 予定
- [ ] データエクスポート機能（CSV/PDF）
- [ ] 履歴保存機能
- [ ] 定期チェック機能
- [ ] 変更検知アラート
- [ ] グラフ・チャート表示
- [ ] 競合サイト比較機能

### [7.0.0] - 予定
- [ ] カスタムレポート生成
- [ ] APIキー設定（SecurityTrails等）
- [ ] サブドメイン検索機能強化
- [ ] SSL証明書情報の詳細表示
- [ ] ブックマーク機能

---

## 📋 バージョニングについて

このプロジェクトは [Semantic Versioning](https://semver.org/) を使用しています。

```
MAJOR.MINOR.PATCH

MAJOR: 互換性のない変更
MINOR: 後方互換性のある機能追加
PATCH: 後方互換性のあるバグ修正
```

**例:**
- `5.1.0` → `6.0.0`: Manifest V4への移行（破壊的変更）
- `5.0.0` → `5.1.0`: メールセキュリティ診断機能の追加（機能追加）
- `5.1.0` → `5.1.1`: サジェスト取得のバグ修正（バグ修正）

---

## 🔗 リンク

- [Keep a Changelog](https://keepachangelog.com/ja/1.0.0/)
- [Semantic Versioning](https://semver.org/lang/ja/)
- [GitHub Releases](https://github.com/yourusername/dns-osint-pro-ver2.0/releases)

---

<p align="center">
  Made with ❤️ by Reverse Rebirth Hack Team
</p>
